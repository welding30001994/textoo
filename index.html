<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor Visual Web</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            display: flex;
            min-height: 100vh;
        }
        
        /* Panel lateral de herramientas */
        .toolbar {
            width: 250px;
            background-color: #2c3e50;
            color: white;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            overflow-y: auto;
        }
        
        .toolbar h2 {
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.4rem;
        }
        
        .tool-section {
            margin-bottom: 25px;
        }
        
        .tool-section h3 {
            margin-bottom: 12px;
            font-size: 1.1rem;
            border-bottom: 1px solid #4a6278;
            padding-bottom: 5px;
        }
        
        .tool-button {
            display: block;
            width: 100%;
            padding: 10px;
            margin-bottom: 8px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .tool-button:hover {
            background-color: #2980b9;
        }
        
        input, select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        /* Área de edición */
        .editor-area {
            flex-grow: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .editor-header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #ddd;
        }
        
        .editor-header h1 {
            color: #2c3e50;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        
        .action-button {
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .save-btn {
            background-color: #2ecc71;
            color: white;
        }
        
        .share-btn {
            background-color: #9b59b6;
            color: white;
        }
        
        .reset-btn {
            background-color: #e74c3c;
            color: white;
        }
        
        .links-btn {
            background-color: #f39c12;
            color: white;
        }
        
        /* Canvas de edición */
        .canvas {
            width: 800px;
            min-height: 600px;
            background-color: white;
            border: 1px solid #ddd;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            padding: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .editable {
            margin-bottom: 15px;
            padding: 10px;
            border: 2px dashed transparent;
            transition: border-color 0.3s;
            cursor: move;
        }
        
        .editable:hover {
            border-color: #3498db;
        }
        
        .editable.selected {
            border-color: #e74c3c;
        }
        
        .editable img {
            max-width: 100%;
            height: auto;
        }
        
        /* Modal para compartir */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-content {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            width: 500px;
            max-width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal h2 {
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .modal input {
            margin-bottom: 15px;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 15px;
        }
        
        /* Lista de enlaces */
        .links-list {
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .link-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .link-item a {
            color: #3498db;
            text-decoration: none;
            flex-grow: 1;
            margin-right: 10px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .link-item button {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        /* Notificaciones */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 20px;
            background-color: #2ecc71;
            color: white;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            display: none;
            z-index: 1001;
        }
        
        /* Vista de enlaces guardados */
        .saved-links-view {
            display: none;
            width: 100%;
            margin-top: 20px;
        }
        
        .saved-links-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .saved-links-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }
        
        .saved-link-card {
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .saved-link-card h3 {
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .saved-link-card a {
            color: #3498db;
            text-decoration: none;
            display: block;
            margin-bottom: 10px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .saved-link-card button {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 5px;
        }
        
        .saved-link-card .view-btn {
            background-color: #2ecc71;
        }
    </style>
    <!-- Importar Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
</head>
<body>
    <div class="container">
        <!-- Panel de herramientas lateral -->
        <div class="toolbar">
            <h2>Herramientas</h2>
            
            <div class="tool-section">
                <h3>Elementos</h3>
                <button class="tool-button" id="add-text-btn">Agregar Texto</button>
                <button class="tool-button" id="add-image-btn">Agregar Imagen</button>
            </div>
            
            <div class="tool-section">
                <h3>Propiedades</h3>
                <input type="text" id="edit-text" placeholder="Editar texto...">
                <input type="color" id="color-picker" value="#000000">
                <select id="font-family">
                    <option value="Arial">Arial</option>
                    <option value="Times New Roman">Times New Roman</option>
                    <option value="Courier New">Courier New</option>
                    <option value="Verdana">Verdana</option>
                    <option value="Georgia">Georgia</option>
                </select>
                <select id="font-size">
                    <option value="12px">Pequeño</option>
                    <option value="16px" selected>Mediano</option>
                    <option value="24px">Grande</option>
                    <option value="32px">Muy Grande</option>
                </select>
            </div>
            
            <div class="tool-section">
                <h3>Alineación</h3>
                <button class="tool-button" id="align-left">Alinear Izquierda</button>
                <button class="tool-button" id="align-center">Alinear Centro</button>
                <button class="tool-button" id="align-right">Alinear Derecha</button>
            </div>
            
            <div class="tool-section">
                <h3>Acciones</h3>
                <button class="tool-button" id="delete-element">Eliminar Elemento</button>
                <button class="tool-button" id="bring-to-front">Traer al Frente</button>
                <button class="tool-button" id="send-to-back">Enviar al Fondo</button>
            </div>
        </div>
        
        <!-- Área principal de edición -->
        <div class="editor-area">
            <div class="editor-header">
                <h1>Editor Visual Web</h1>
                <div class="action-buttons">
                    <button class="action-button save-btn" id="save-btn">Guardar Proyecto</button>
                    <button class="action-button share-btn" id="share-btn">Compartir</button>
                    <button class="action-button links-btn" id="links-btn">Mis Enlaces</button>
                    <button class="action-button reset-btn" id="reset-btn">Nuevo Proyecto</button>
                </div>
            </div>
            
            <div class="canvas" id="canvas">
                <!-- Aquí se agregarán los elementos editables -->
                <div class="editable" style="text-align: center;">
                    <h2 style="color: #3498db;">Haz clic para editar este título</h2>
                    <p>Haz clic aquí para cambiar este texto. Puedes agregar imágenes, cambiar colores y mucho más.</p>
                </div>
            </div>
            
            <!-- Vista de enlaces guardados -->
            <div class="saved-links-view" id="saved-links-view">
                <div class="saved-links-header">
                    <h2>Mis Páginas Guardadas</h2>
                    <button class="action-button" id="back-to-editor">Volver al Editor</button>
                </div>
                <div class="saved-links-list" id="saved-links-list">
                    <!-- Los enlaces se cargarán aquí -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para compartir -->
    <div class="modal" id="share-modal">
        <div class="modal-content">
            <h2>Compartir tu creación</h2>
            <p>Tu proyecto se ha guardado. Comparte este enlace con otras personas:</p>
            <input type="text" id="share-link" readonly>
            
            <h3 style="margin-top: 20px;">Tus páginas guardadas:</h3>
            <div class="links-list" id="links-list">
                <!-- Los enlaces se cargarán aquí -->
            </div>
            
            <div class="modal-buttons">
                <button class="tool-button" id="copy-link">Copiar Enlace</button>
                <button class="tool-button" style="background-color: #95a5a6;" id="close-modal">Cerrar</button>
            </div>
        </div>
    </div>
    
    <!-- Notificación -->
    <div class="notification" id="notification">
        ¡Cambios guardados exitosamente!
    </div>

    <script>
        // Configuración de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyD3MI1klgBSHs1h6QT4VPNoScCfCwMV_Ck",
            authDomain: "usuario-b0384.firebaseapp.com",
            databaseURL: "https://usuario-b0384-default-rtdb.firebaseio.com",
            projectId: "usuario-b0384",
            storageBucket: "usuario-b0384.firebasestorage.app",
            messagingSenderId: "196266170863",
            appId: "1:196266170863:web:4ea57f489df94aba94fe1a"
        };
        
        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        
        document.addEventListener('DOMContentLoaded', function() {
            // Variables globales
            let selectedElement = null;
            let elementCount = 0;
            let isDragging = false;
            let startX, startY, initialLeft, initialTop;
            
            // Referencias a elementos DOM
            const canvas = document.getElementById('canvas');
            const addTextBtn = document.getElementById('add-text-btn');
            const addImageBtn = document.getElementById('add-image-btn');
            const editTextInput = document.getElementById('edit-text');
            const colorPicker = document.getElementById('color-picker');
            const fontFamily = document.getElementById('font-family');
            const fontSize = document.getElementById('font-size');
            const alignLeft = document.getElementById('align-left');
            const alignCenter = document.getElementById('align-center');
            const alignRight = document.getElementById('align-right');
            const deleteElement = document.getElementById('delete-element');
            const bringToFront = document.getElementById('bring-to-front');
            const sendToBack = document.getElementById('send-to-back');
            const saveBtn = document.getElementById('save-btn');
            const shareBtn = document.getElementById('share-btn');
            const linksBtn = document.getElementById('links-btn');
            const resetBtn = document.getElementById('reset-btn');
            const shareModal = document.getElementById('share-modal');
            const shareLink = document.getElementById('share-link');
            const linksList = document.getElementById('links-list');
            const copyLink = document.getElementById('copy-link');
            const closeModal = document.getElementById('close-modal');
            const notification = document.getElementById('notification');
            const savedLinksView = document.getElementById('saved-links-view');
            const savedLinksList = document.getElementById('saved-links-list');
            const backToEditor = document.getElementById('back-to-editor');
            
            // Inicializar con el primer elemento seleccionado
            selectElement(document.querySelector('.editable'));
            
            // Función para seleccionar un elemento
            function selectElement(element) {
                // Deseleccionar elemento anterior
                if (selectedElement) {
                    selectedElement.classList.remove('selected');
                }
                
                // Seleccionar nuevo elemento
                selectedElement = element;
                selectedElement.classList.add('selected');
                
                // Actualizar controles con las propiedades del elemento
                if (selectedElement.tagName === 'IMG') {
                    editTextInput.value = '';
                    editTextInput.disabled = true;
                } else {
                    editTextInput.disabled = false;
                    editTextInput.value = selectedElement.innerText;
                    colorPicker.value = rgbToHex(selectedElement.style.color || '#000000');
                    fontFamily.value = selectedElement.style.fontFamily || 'Arial';
                    fontSize.value = selectedElement.style.fontSize || '16px';
                }
            }
            
            // Convertir RGB a HEX (para el selector de color)
            function rgbToHex(rgb) {
                if (!rgb || rgb === '') return '#000000';
                
                if (rgb.indexOf('rgb') === -1) return rgb;
                
                const rgbValues = rgb.match(/\d+/g);
                return '#' + ((1 << 24) + (parseInt(rgbValues[0]) << 16) + 
                            (parseInt(rgbValues[1]) << 8) + parseInt(rgbValues[2])).toString(16).slice(1);
            }
            
            // Agregar texto editable
            addTextBtn.addEventListener('click', function() {
                elementCount++;
                const newText = document.createElement('div');
                newText.className = 'editable';
                newText.innerHTML = '<p>Nuevo texto ' + elementCount + ' - haz clic para editar</p>';
                newText.style.margin = '10px 0';
                
                canvas.appendChild(newText);
                selectElement(newText);
                
                // Hacer el nuevo texto editable inmediatamente
                makeElementEditable(newText);
                makeElementDraggable(newText);
            });
            
            // Agregar imagen
            addImageBtn.addEventListener('click', function() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                
                input.onchange = function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            elementCount++;
                            const newImage = document.createElement('img');
                            newImage.src = event.target.result;
                            newImage.className = 'editable';
                            newImage.style.maxWidth = '100%';
                            newImage.style.margin = '10px 0';
                            
                            canvas.appendChild(newImage);
                            selectElement(newImage);
                            
                            // Hacer la imagen arrastrable y seleccionable
                            makeElementEditable(newImage);
                            makeElementDraggable(newImage);
                        };
                        reader.readAsDataURL(file);
                    }
                };
                
                input.click();
            });
            
            // Hacer elementos editables y seleccionables
            function makeElementEditable(element) {
                element.addEventListener('click', function(e) {
                    e.stopPropagation();
                    selectElement(element);
                });
                
                // Hacer texto editable al hacer doble clic
                if (element.tagName !== 'IMG') {
                    element.addEventListener('dblclick', function() {
                        this.setAttribute('contenteditable', 'true');
                        this.focus();
                    });
                    
                    element.addEventListener('blur', function() {
                        this.removeAttribute('contenteditable');
                    });
                }
            }
            
            // Hacer elementos arrastrables
            function makeElementDraggable(element) {
                element.addEventListener('mousedown', function(e) {
                    if (e.target !== element && !element.contains(e.target)) return;
                    
                    isDragging = true;
                    selectedElement = element;
                    selectElement(element);
                    
                    // Guardar posición inicial
                    startX = e.clientX;
                    startY = e.clientY;
                    initialLeft = parseInt(window.getComputedStyle(element).left) || 0;
                    initialTop = parseInt(window.getComputedStyle(element).top) || 0;
                    
                    // Establecer posición absoluta si no está establecida
                    if (window.getComputedStyle(element).position === 'static') {
                        element.style.position = 'absolute';
                    }
                    
                    document.addEventListener('mousemove', dragElement);
                    document.addEventListener('mouseup', stopDrag);
                    
                    e.preventDefault();
                });
            }
            
            function dragElement(e) {
                if (!isDragging) return;
                
                const dx = e.clientX - startX;
                const dy = e.clientY - startY;
                
                selectedElement.style.left = (initialLeft + dx) + 'px';
                selectedElement.style.top = (initialTop + dy) + 'px';
            }
            
            function stopDrag() {
                isDragging = false;
                document.removeEventListener('mousemove', dragElement);
                document.removeEventListener('mouseup', stopDrag);
            }
            
            // Inicializar elementos existentes
            document.querySelectorAll('.editable').forEach(function(element) {
                makeElementEditable(element);
                makeElementDraggable(element);
            });
            
            // Permitir hacer clic en el canvas para deseleccionar
            canvas.addEventListener('click', function(e) {
                if (e.target === canvas) {
                    if (selectedElement) {
                        selectedElement.classList.remove('selected');
                        selectedElement = null;
                        editTextInput.value = '';
                    }
                }
            });
            
            // Actualizar texto del elemento seleccionado
            editTextInput.addEventListener('input', function() {
                if (selectedElement && selectedElement.tagName !== 'IMG') {
                    selectedElement.innerText = editTextInput.value;
                }
            });
            
            // Cambiar color del texto
            colorPicker.addEventListener('input', function() {
                if (selectedElement && selectedElement.tagName !== 'IMG') {
                    selectedElement.style.color = colorPicker.value;
                }
            });
            
            // Cambiar fuente
            fontFamily.addEventListener('change', function() {
                if (selectedElement && selectedElement.tagName !== 'IMG') {
                    selectedElement.style.fontFamily = fontFamily.value;
                }
            });
            
            // Cambiar tamaño de fuente
            fontSize.addEventListener('change', function() {
                if (selectedElement && selectedElement.tagName !== 'IMG') {
                    selectedElement.style.fontSize = fontSize.value;
                }
            });
            
            // Alineación de texto
            alignLeft.addEventListener('click', function() {
                if (selectedElement && selectedElement.tagName !== 'IMG') {
                    selectedElement.style.textAlign = 'left';
                }
            });
            
            alignCenter.addEventListener('click', function() {
                if (selectedElement && selectedElement.tagName !== 'IMG') {
                    selectedElement.style.textAlign = 'center';
                }
            });
            
            alignRight.addEventListener('click', function() {
                if (selectedElement && selectedElement.tagName !== 'IMG') {
                    selectedElement.style.textAlign = 'right';
                }
            });
            
            // Eliminar elemento
            deleteElement.addEventListener('click', function() {
                if (selectedElement) {
                    selectedElement.remove();
                    selectedElement = null;
                    editTextInput.value = '';
                }
            });
            
            // Traer al frente
            bringToFront.addEventListener('click', function() {
                if (selectedElement) {
                    canvas.appendChild(selectedElement);
                }
            });
            
            // Enviar al fondo
            sendToBack.addEventListener('click', function() {
                if (selectedElement) {
                    canvas.insertBefore(selectedElement, canvas.firstChild);
                }
            });
            
            // Guardar proyecto en Firebase
            saveBtn.addEventListener('click', function() {
                const projectData = {
                    content: canvas.innerHTML,
                    timestamp: Date.now(),
                    title: prompt("¿Cómo quieres llamar a tu proyecto?", "Mi Proyecto") || "Mi Proyecto"
                };
                
                // Guardar en Firebase
                const newProjectRef = database.ref('projects').push();
                newProjectRef.set(projectData)
                    .then(() => {
                        // Mostrar enlace
                        const projectId = newProjectRef.key;
                        const shareUrl = `${window.location.origin}${window.location.pathname}?view=${projectId}`;
                        
                        showNotification('¡Proyecto guardado exitosamente!');
                        
                        // Guardar en localStorage para acceso rápido
                        saveProjectLink(projectId, projectData.title, shareUrl);
                    })
                    .catch(error => {
                        console.error("Error al guardar:", error);
                        showNotification('Error al guardar el proyecto');
                    });
            });
            
            // Guardar enlace en localStorage
            function saveProjectLink(id, title, url) {
                let savedProjects = JSON.parse(localStorage.getItem('savedProjects') || '{}');
                savedProjects[id] = { title, url };
                localStorage.setItem('savedProjects', JSON.stringify(savedProjects));
            }
            
            // Cargar enlaces guardados
            function loadSavedProjects() {
                const savedProjects = JSON.parse(localStorage.getItem('savedProjects') || '{}');
                return savedProjects;
            }
            
            // Compartir proyecto
            shareBtn.addEventListener('click', function() {
                const savedProjects = loadSavedProjects();
                const linksList = document.getElementById('links-list');
                linksList.innerHTML = '';
                
                if (Object.keys(savedProjects).length === 0) {
                    linksList.innerHTML = '<p>No tienes proyectos guardados todavía.</p>';
                } else {
                    for (const [id, project] of Object.entries(savedProjects)) {
                        const linkItem = document.createElement('div');
                        linkItem.className = 'link-item';
                        linkItem.innerHTML = `
                            <a href="${project.url}" target="_blank">${project.title}</a>
                            <button class="delete-link" data-id="${id}">Eliminar</button>
                        `;
                        linksList.appendChild(linkItem);
                    }
                    
                    // Agregar event listeners para botones de eliminar
                    document.querySelectorAll('.delete-link').forEach(button => {
                        button.addEventListener('click', function() {
                            const projectId = this.getAttribute('data-id');
                            deleteProject(projectId);
                        });
                    });
                }
                
                shareModal.style.display = 'flex';
            });
            
            // Eliminar proyecto
            function deleteProject(projectId) {
                // Eliminar de Firebase
                database.ref('projects/' + projectId).remove()
                    .then(() => {
                        // Eliminar de localStorage
                        let savedProjects = JSON.parse(localStorage.getItem('savedProjects') || '{}');
                        delete savedProjects[projectId];
                        localStorage.setItem('savedProjects', JSON.stringify(savedProjects));
                        
                        showNotification('Proyecto eliminado');
                        shareBtn.click(); // Recargar la lista
                    })
                    .catch(error => {
                        console.error("Error al eliminar:", error);
                        showNotification('Error al eliminar el proyecto');
                    });
            }
            
            // Mostrar mis enlaces
            linksBtn.addEventListener('click', function() {
                const savedProjects = loadSavedProjects();
                const savedLinksList = document.getElementById('saved-links-list');
                savedLinksList.innerHTML = '';
                
                if (Object.keys(savedProjects).length === 0) {
                    savedLinksList.innerHTML = '<p>No tienes proyectos guardados todavía.</p>';
                } else {
                    for (const [id, project] of Object.entries(savedProjects)) {
                        const linkCard = document.createElement('div');
                        linkCard.className = 'saved-link-card';
                        linkCard.innerHTML = `
                            <h3>${project.title}</h3>
                            <a href="${project.url}" target="_blank">${project.url}</a>
                            <div>
                                <button class="view-btn" data-url="${project.url}">Ver</button>
                                <button class="delete-link" data-id="${id}">Eliminar</button>
                            </div>
                        `;
                        savedLinksList.appendChild(linkCard);
                    }
                    
                    // Agregar event listeners
                    document.querySelectorAll('.view-btn').forEach(button => {
                        button.addEventListener('click', function() {
                            const url = this.getAttribute('data-url');
                            window.open(url, '_blank');
                        });
                    });
                    
                    document.querySelectorAll('.delete-link').forEach(button => {
                        button.addEventListener('click', function() {
                            const projectId = this.getAttribute('data-id');
                            deleteProject(projectId);
                        });
                    });
                }
                
                // Mostrar vista de enlaces
                canvas.style.display = 'none';
                savedLinksView.style.display = 'block';
            });
            
            // Volver al editor
            backToEditor.addEventListener('click', function() {
                savedLinksView.style.display = 'none';
                canvas.style.display = 'block';
            });
            
            // Nuevo proyecto
            resetBtn.addEventListener('click', function() {
                if (confirm('¿Estás seguro de que quieres comenzar un nuevo proyecto? Se perderán todos los cambios no guardados.')) {
                    canvas.innerHTML = '';
                    selectedElement = null;
                    editTextInput.value = '';
                    
                    // Agregar elemento inicial
                    const initialElement = document.createElement('div');
                    initialElement.className = 'editable';
                    initialElement.innerHTML = '<h2 style="color: #3498db; text-align: center;">Haz clic para editar este título</h2><p style="text-align: center;">Haz clic aquí para cambiar este texto. Puedes agregar imágenes, cambiar colores y mucho más.</p>';
                    
                    canvas.appendChild(initialElement);
                    makeElementEditable(initialElement);
                    makeElementDraggable(initialElement);
                    selectElement(initialElement);
                }
            });
            
            // Cerrar modal
            closeModal.addEventListener('click', function() {
                shareModal.style.display = 'none';
            });
            
            // Mostrar notificación
            function showNotification(message) {
                notification.textContent = message;
                notification.style.display = 'block';
                
                setTimeout(function() {
                    notification.style.display = 'none';
                }, 3000);
            }
            
            // Comprobar si estamos en modo visualización
            const urlParams = new URLSearchParams(window.location.search);
            const viewParam = urlParams.get('view');
            
            if (viewParam) {
                // Ocultar herramientas y mostrar solo el contenido
                document.querySelector('.toolbar').style.display = 'none';
                document.querySelector('.editor-header').style.display = 'none';
                
                // Cargar el proyecto desde Firebase
                database.ref('projects/' + viewParam).once('value')
                    .then(snapshot => {
                        const projectData = snapshot.val();
                        if (projectData) {
                            canvas.innerHTML = projectData.content;
                            
                            // Deshabilitar edición
                            document.querySelectorAll('.editable').forEach(element => {
                                element.style.pointerEvents = 'none';
                                element.style.border = 'none';
                            });
                        } else {
                            canvas.innerHTML = '<p>El proyecto no existe o ha sido eliminado.</p>';
                        }
                    })
                    .catch(error => {
                        console.error("Error al cargar:", error);
                        canvas.innerHTML = '<p>Error al cargar el proyecto.</p>';
                    });
            }
        });
    </script>
</body>
</html>
